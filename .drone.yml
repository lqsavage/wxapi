workspace:
  base: /root
  path: /wxapi

pipeline:
  backend:
    image: golang
    commands:
      - CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o ./auth/app ./auth
  docker:
    image: plugins/docker
    repo: coderxu/wxapi_auth
    target: production
    username: coderxu
    password: wangxu226
    dockerfile: ./auth/Dockerfile
  ssh:
    image: appleboy/drone-ssh
    host: 45.76.96.204
    username: root
    password: k4W)YTgK1w,(mVZC
    port: 22
    script:
      - sudo docker ps
      - sudo docker run --name wxapi_auth -p 8021:8021 -d coderxu/wxapi_auth
      


